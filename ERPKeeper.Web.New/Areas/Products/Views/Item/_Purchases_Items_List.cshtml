@model ERPKeeperCore.Enterprise.Models.Items.Item





@{
    var CommercialItems = Organization.ErpCOREDBContext.PurchaseItems.ToList();
}


<style>
    .dx-treelist .dx-row > td {
        padding: 2px !important;
    }
</style>


<div id="treeListDemo" class="mb-3 border">

    @(Html.DevExtreme().DataGrid<ERPKeeperCore.Enterprise.Models.Suppliers.PurchaseItem>()
            .ID("gridList")
            .DataSource(CommercialItems)
            .KeyExpr("Id").GroupPanel(groupPanel => groupPanel.Visible(true))
            .ShowRowLines(true)
            .ShowBorders(false)
            .Width("100%")
            .Paging(paging => paging.PageSize(100))
            .HeaderFilter(headerFilter => headerFilter.Visible(true).Search(s=>s.Enabled(true)))

            .ColumnAutoWidth(false)
            .Columns(columns =>
            {
                columns.AddFor(m => m.Purchase.Date).SortOrder(SortOrder.Desc).SortIndex(1).Width(130);
                columns.AddFor(m => m.Purchase.Status).Width(60).SortOrder(SortOrder.Asc).SortIndex(2).Lookup(lookup => lookup
            .DataSource(Html.GetEnumSelectList<ERPKeeperCore.Enterprise.Models.Suppliers.Enums.PurchaseStatus>().Select(i => new { Value = int.Parse(i.Value), Text = i.Text }))
            .DisplayExpr("Text")
            .ValueExpr("Value")
            );
                columns.AddFor(m => m.Purchase.Name)
            .Width(150)
            .CellTemplate(@<text>
        <a href="/@CompanyId/Profiles/Suppliers/Purchase/<%= data.Commercial.Id %>/">
            <%= data.Commercial.Name %>
        </a>
    </text>);

                columns.AddFor(m => m.Purchase.Supplier.Profile.Name).HeaderCellTemplate(@<text>Customer</text>)
    .CellTemplate(@<text>
        <a href="/@CompanyId/Profiles/Suppliers/Purchase/<%= data.Commercial.Profile.Id %>/">
            <%= data.Commercial.Profile.Name %>
        </a>
    </text>);

                columns.AddFor(m => m.Purchase.Reference);
                columns.Add().DataField("Amount").Width(80).Format("#,##0.00");
                columns.Add().DataField("SalePrice").Width(80).Format("#,##0.00");
                columns.Add().DataField("LineTotal").Width(80).Format("#,##0.00");
                //columns.Add().DataField("Id");
            })
        )
</div>

