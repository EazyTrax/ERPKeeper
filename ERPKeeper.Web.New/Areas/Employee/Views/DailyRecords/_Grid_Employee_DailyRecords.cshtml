<div id="treeList" class="">

    @(Html.DevExtreme().DataGrid<ERPKeeperCore.Enterprise.Models.Employees.EmployeeDailyRecord>()
        .ID("gridList")
        .DataSource(d => d.RemoteController().Key("Id")
        .LoadUrl($"/API/HR/Employees/{EmployeeId}/EmployeeDailyRecords/All")
        .InsertUrl($"/API/HR/Employees/{EmployeeId}/EmployeeDailyRecords/Insert")
        .UpdateUrl($"/API/HR/Employees/{EmployeeId}/EmployeeDailyRecords/Update").UpdateMethod("Post")
        .DeleteUrl($"/API/HR/Employees/{EmployeeId}/EmployeeDailyRecords/Delete").DeleteMethod("Post")
        )
        .KeyExpr("Id")
        .RowAlternationEnabled(true).AllowColumnReordering(true)
        .ShowRowLines(true)
        .ShowBorders(false)
        .Width("100%")
        .Paging(paging => paging.PageSize(100))
        .StateStoring(s => s.Enabled(true).Type(StateStoringType.SessionStorage).StorageKey("EmployeeDailyRecords"))
        .GroupPanel(gp => gp.Visible(true)) 
        .ColumnChooser(columnChooser => columnChooser.Enabled(true))    
        .AllowColumnResizing(true).AllowColumnReordering(true)
        .HeaderFilter(headerFilter => headerFilter.Visible(true).Search(s=>s.Enabled(true)))
        .FilterRow(filterRow => filterRow
        .Visible(true)
        .ApplyFilter(GridApplyFilterMode.Auto)
        )
        .ColumnAutoWidth(false)
        .RowDragging(rd => rd
        .AllowDropInsideItem(false)
        .AllowReordering(false)
        )
        .Columns(columns =>
        {
            columns.AddFor(m => m.RecordDate)
                .Width(130)
                .SortIndex(0)
                .SortOrder(SortOrder.Desc)
                .Format(Format.ShortDate)
                .HeaderCellTemplate(@<text>Date</text>)
                .CellTemplate(@<text><a href="/HR/EmployeeDailyRecords/<%= data.Id %>/"><%= displayValue %></a></text>);

            columns.AddFor(m => m.Type)
                .Width(150)
                .HeaderCellTemplate(@<text>Attendance Type</text>)
                .CellTemplate(@<text>
                    <span class="badge badge-<%= data.Type === 0 ? 'success' : (data.Type === 5 ? 'info' : 'warning') %>">
                        <%= displayValue %>
                    </span>
                </text>);

            columns.AddFor(m => m.Status)
                .Width(100)
                .HeaderCellTemplate(@<text>Status</text>)
                .CellTemplate(@<text>
                    <span class="badge badge-<%= data.Status === 0 ? 'success' : (data.Status === 1 ? 'warning' : 'danger') %>">
                        <%= displayValue %>
                    </span>
                </text>);

            columns.AddFor(m => m.Notes)
                .Width(250)
                .HeaderCellTemplate(@<text>Notes</text>);
        })
        .Summary(s => s.TotalItems(items =>
        {
            items.Add()
                .Column("Type")
                .SummaryType(SummaryType.Count)
                .CustomizeText("function(data) { return 'Total Days: ' + data.value; }");
        }))
    )
</div>


