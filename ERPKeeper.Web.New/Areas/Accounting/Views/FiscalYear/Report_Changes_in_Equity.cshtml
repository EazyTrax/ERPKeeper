@model ERPKeeperCore.Enterprise.Models.Accounting.FiscalYear
@using ERPKeeperCore.Enterprise.Models.Accounting.Enums


<div class="row">
    <div class="col-8 p-3 col-center mh-100v border-right border-2">
        <div class="text-center font-weight-600  mb-3">
            บริษัท เดอะ เอ็นจิเนียริ่ง คร๊าฟ จำกัด<br />
            งบแสดงการเปลี่ยนแปลงในส่วนของผู้ถือหุ้น<br />
            ณ วันที่  31 ธันวาคม @(Model.EndDate.Year - 1 + 543) และ @(Model.EndDate.Year + 543)
        </div>
        <div class="row mt-4">
            <div class="col-6">
            </div>
            <div class="col-6 font-weight-600 text-center">
                หน่วย:บาท
            </div>
            <div class="col-6  font-weight-600 ">
            </div>
            <div class="col-2 p-0 text-right font-weight-600 border-dark border-top  ">
                ทุนที่ชำระแล้ว
            </div>
            <div class="col-2 p-0 text-right font-weight-600 border-dark border-top  ">
                กำไร(ขาดทุน) <br />
                สะสม
            </div>
            <div class="col-2 p-0 text-right font-weight-600 border-dark border-top  ">
                รวม
            </div>
        </div>

        @{
            var stock = Model.FiscalYearAccountBalances
            .Where(m => m.Account.Type == ERPKeeperCore.Enterprise.Models.Accounting.Enums.AccountTypes.Capital)
            .Where(m => m.Account.SubType == AccountSubTypes.Equity_Stock)
            .First();

            var retainedEarning = Model.FiscalYearAccountBalances
            .Where(m => m.Account.Type == ERPKeeperCore.Enterprise.Models.Accounting.Enums.AccountTypes.Capital)
            .Where(m => m.Account.SubType == AccountSubTypes.Equity_RetainEarning)
            .First();
        }

        <div class="row">
            <div class="col-6   ">
                ยอดคงเหลือ ณ ต้นงวด  @(Model.EndDate.Year - 1 + 543)
            </div>
            <div class="col-2 p-0 text-right border-dark border-top  ">
                @stock.OpeningCredit.ToString("N2")
            </div>
            <div class="col-2 p-0 text-right  border-dark border-top  ">
                @retainedEarning.OpeningCredit.ToString("N2")
            </div>
            <div class="col-2 p-0 text-right  border-dark border-top  ">
                @((stock.OpeningCredit + retainedEarning.OpeningCredit).ToString("N2"))
            </div>
        </div>

        <div class="row">
            <div class="col-6   ">
                จ่ายเงินปันผล
            </div>
            <div class="col-2 p-0 text-right  border-dark border-top  ">
            </div>
            <div class="col-2 p-0 text-right  border-dark border-top  ">
                (@retainedEarning.Debit.ToString("N2"))
            </div>
            <div class="col-2 p-0 text-right border-dark border-top  ">
                (@retainedEarning.Debit.ToString("N2"))
            </div>
        </div>

        <div class="row">
            <div class="col-6   ">
                กำไร(ขาดทุน) สุทธิ สำหรับงวด @(Model.EndDate.Year + 543)
            </div>
            <div class="col-2 p-0 text-right  border-dark border-top  ">
            </div>
            <div class="col-2 p-0 text-right  border-dark border-top  ">
                @retainedEarning.ClosingCredit.ToString("N2")
            </div>
            <div class="col-2 p-0 text-right border-dark border-top  ">
                @retainedEarning.ClosingCredit.ToString("N2")
            </div>
        </div>
        <div class="row">
            <div class="col-6   ">
                ยอดคงเหลือปลายงวด  @(Model.EndDate.Year + 543)
            </div>
            <div class="col-2 p-0 text-right  border-dark border-top  ">
                @stock.ClosedCredit.ToString("N2")
            </div>
            <div class="col-2 p-0 text-right  border-dark border-top  ">
                @retainedEarning.ClosedCredit.ToString("N2")
            </div>
            <div class="col-2 p-0 text-right border-dark border-top  ">
                @((stock.ClosedCredit + retainedEarning.ClosedCredit).ToString("N2"))
            </div>
        </div>
    </div>
</div>